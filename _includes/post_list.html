<!-- FILTER MENU -->
<nav class="writings-nav" aria-label="Filter writings">
  <button type="button" class="writings-nav-btn active" onclick="filterPosts('all')">
    {% if page.lang == "en" %}All{% elsif page.lang == "az" %}Bütün{% endif %}
  </button>
  {% assign categories = site.posts | where: "lang", page.lang | map: 'category' | uniq %}
  {% for category in categories %}
    {% if category and category != "" %}
      <button type="button" class="writings-nav-btn" onclick="filterPosts('{{ category }}')">{{ category | capitalize }}</button>
    {% endif %}
  {% endfor %}
  <button type="button" class="writings-nav-btn" onclick="filterPosts('uncategorized')">
    {% if page.lang == "en" %}Uncategorized{% elsif page.lang == "az" %}Kateqoriyasız{% endif %}
  </button>
</nav>

<!-- WRITINGS LIST -->
<ul class="writings-list">
  {% assign lang_posts = site.posts | where: "lang", page.lang | sort: "date" | reverse %}
  {% for post in lang_posts %}
    {% assign post_categories = post.category %}
    {% if post_categories == nil or post_categories == "" %}
      {% assign post_categories = "uncategorized" %}
    {% elsif post_categories != "" and post_categories != nil %}
      {% assign post_categories = post_categories | join: ',' %}
    {% endif %}
    <li class="writings-item writing" data-category="{{ post_categories }}">
      <time class="writings-date" datetime="{{ post.date | date: '%Y-%m-%d' }}">{{ post.date | date: "%d %b %Y" }}</time>
      <a href="{{ post.url | relative_url }}" class="writings-link">{{ post.title }}</a>
    </li>
  {% endfor %}
</ul>

<!-- STYLES -->
<style>
  .writings-title { margin-bottom: 0.25em; }
  .writings-nav {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 4px;
    margin: 0.75em 0 0.5em;
  }
  .writings-nav-btn {
    flex: 0 0 auto;
    padding: 4px 10px;
    font-size: 0.8rem;
    font-weight: 500;
    color: #495057;
    background: #f1f3f4;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.15s, color 0.15s, border-color 0.15s;
  }
  .writings-nav-btn:hover {
    background: #e8eaed;
    color: #1a1a1a;
  }
  .writings-nav-btn.active {
    background: #2c3e50;
    color: #fff;
    border-color: #2c3e50;
  }
  .writings-list {
    list-style: none;
    padding: 0;
    margin: 0.5em 0 0;
  }
  .writings-item {
    display: flex;
    align-items: baseline;
    gap: 0.75em;
    padding: 0.35em 0;
    font-size: 1rem;
    line-height: 1.35;
    border-bottom: 1px solid #eee;
  }
  .writings-item:last-child { border-bottom: none; }
  .writings-date {
    flex-shrink: 0;
    width: 11ch;
    font-size: 0.8rem;
    color: #6c757d;
    font-variant-numeric: tabular-nums;
  }
  .writings-link {
    text-decoration: none;
    color: #2c3e50;
    font-weight: 500;
    transition: color 0.15s;
  }
  .writings-link:hover { color: #556a9a; }
  @media screen and (max-width: 700px) {
    .writings-nav { flex-direction: row; }
    .writings-item { flex-wrap: wrap; gap: 0.25em; }
    .writings-date { font-size: 0.75rem; width: 11ch; }
  }
</style>

<!-- SCRIPT -->
<script>
  function filterPosts(category) {
    const items = document.querySelectorAll('.writing');
    const buttons = document.querySelectorAll('.writings-nav-btn');

    buttons.forEach(btn => btn.classList.remove('active'));
    const matchBtn = Array.from(buttons).find(btn =>
      btn.textContent.trim().toLowerCase() === category.toLowerCase() ||
      (category === 'all' && btn.textContent.trim().toLowerCase() === 'all') ||
      (category === 'uncategorized' && ['uncategorized', 'kateqoriyasız'].includes(btn.textContent.trim().toLowerCase()))
    );
    if (matchBtn) matchBtn.classList.add('active');

    items.forEach(item => {
      const categories = item.dataset.category.split(',');
      item.style.display = (category === 'all' || categories.includes(category)) ? 'flex' : 'none';
    });
  }
</script>
